{
  "fileVersion": "1.0.0",
  "name": "AntiMalware",
  "fullName": "AntiMalware",
  "toolVersion": "1.1.1",
  "shortDescription": "A command line utility for running Microsoft AntiMalware/Windows Defender tool.",
  "longDescription": "This is a command line utility for running Microsoft AntiMalware/Windows Defender tool. It must be run on a local machine (or build agent) with Windows Defender already installed.",
  "links": [
    {
      "name": "Windows Defender",
      "uri": "https://www.microsoft.com/en-us/windows/comprehensive-security"
    }
  ],
  "launcher": "NetCore",
  "executablePath": "tools\\Microsoft.Guardian.AntiMalware.Cli.dll",
  "successfulExitCodes": [ 0 ],
  "errorExitCodes": {
    "2": "Malware is found and not remediated or additional user action is required to complete remediation or there is error in scanning."
  },
  "errorHelperMessage": "For help troubleshooting errors based on the HRESULT error code returned by Defender (Windows Update), please visit https://social.technet.microsoft.com/wiki/contents/articles/15260.windows-update-agent-error-codes.aspx or https://www.1eswiki.com/wiki/AntiMalware_Scan_VSTS_Build_Task#Windows_Defender_Errors.",
  "packages": [
    {
      "master": true,
      "version": "1.1.1",
      "type": "nuget",
      "name": "Microsoft.Security.CodeAnalysis.AntiMalware.Cli",
      "sources": [
        {
          "name": "MSCA.Plugins"
        }
      ]
    }
  ],
  "arguments": [
    {
      "id": "Function",
      "displayName": "Function",
      "argumentType": "verb",
      "default": "analyze",
      "required": true,
      "sortOrder": -2
    },
    {
      "id": "Command",
      "displayName": "Command",
      "key": "Command",
      "argumentType": "verb",
      "default": "scan",
      "required": true,
      "sortOrder": -1
    },
    {
      "id": "ScanType",
      "displayName": "Scan Type",
      "key": "scan-type",
      "argumentType": "keyValue",
      "default": 3,
      "required": true
    },
    {
      "id": "ScanDirectoryOrFile",
      "displayName": "Scan Directory or File",
      "key": "file",
      "argumentType": "keyValue",
      "default": "$(WorkingDirectory)"
    },
    {
      "id": "DisableRemediation",
      "displayName": "Disable Remediation",
      "key": "disable-remediation",
      "argumentType": "switch",
      "default": true
    },
    {
      "id": "BootSectorScan",
      "displayName": "Boot Sector Scan",
      "key": "boot-sector-scan",
      "argumentType": "switch",
      "default": false
    },
    {
      "id": "EnableServices",
      "displayName": "Enable Services",
      "key": "enable-services",
      "argumentType": "switch",
      "default": false
    },
    {
      "id": "CollectLogsOnError",
      "displayName": "Collect Logs on Error",
      "key": "collect-logs-on-error",
      "argumentType": "switch",
      "default": false
    },
    {
      "id": "SignatureFreshness",
      "displayName": "Signature Freshness",
      "key": "signature-freshness",
      "argumentType": "keyValue",
      "default": 0
    },
    {
      "id": "OutdatedSignatureAsWarning",
      "displayName": "Outdated Signature as Warning",
      "key": "outdated-signature-as-warning",
      "argumentType": "switch",
      "default": false
    },
    {
      "id": "Output",
      "displayName": "Output",
      "key": "output",
      "argumentType": "keyValue"
    },
    {
      "id": "LoggerLevel",
      "displayName": "Logger Level",
      "key": "logger-level",
      "argumentType": "keyValue",
      "default": "Standard"
    }
  ],
  "commandLineOptions": {
    "keyValueSeparator": " ",
    "argumentPrefix": "--",
    "aliasPrefix": "-",
    "outputArgumentId": "Output"
  },
  "outputExtension": "sarif",
  "supportsBugFiling": false,
  "converterInfo": {
    "convertExpected": false
  }
}